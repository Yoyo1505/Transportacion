<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cotizaciones TAE - Versión Depurada</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f8f9fa; }
    .container { max-width: 1000px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    h1 { color: #0d1120; text-align: center; }
    .controls { display: flex; gap: 10px; margin: 15px 0; flex-wrap: wrap; }
    select, input, button { padding: 10px; border: 1px solid #ccc; border-radius: 6px; }
    button { background: #0d1120; color: white; cursor: pointer; }
    button:hover { background: #1a2440; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    th, td { padding: 10px; text-align: left; border-bottom: 1px solid #eee; }
    th { background: #0d1120; color: white; }
    .total { font-size: 1.4em; font-weight: bold; text-align: right; margin-top: 15px; }
    .remove { background: #dc3545; color: white; border: none; padding: 6px 10px; cursor: pointer; }
  </style>
</head>
<body>

<div class="container">
  <h1>TAE Transportación - Cotizaciones</h1>

  <div class="controls">
    <select id="item">
      <option value="">— Selecciona ítem —</option>
      <option value="AUTOBUS 45 PLAZAS">AUTOBUS 45 PLAZAS</option>
      <option value="SPRINTER">SPRINTER</option>
      <option value="SUBURBAN">SUBURBAN</option>
      <option value="SEDAN">SEDAN</option>
      <option value="HOSPEDAJE">HOSPEDAJE</option>
      <option value="VIATICOS">VIATICOS</option>
      <!-- Agrega los demás aquí si quieres -->
    </select>
    <button id="agregar">Agregar Ítem</button>
  </div>

  <table id="tabla">
    <thead>
      <tr>
        <th>Cant.</th>
        <th>Servicio</th>
        <th>P. Unitario</th>
        <th>Total</th>
        <th></th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="total">TOTAL: <span id="total">$0.00</span></div>

  <div style="margin-top:20px; text-align:center;">
    <button onclick="alert('Función PDF pendiente - dime si la quieres completa')">Generar PDF</button>
  </div>
</div>

<script>
// ────────────────────────────────────────────────
//          ¡Código ultra simple y con depuración!
// ────────────────────────────────────────────────

const btn = document.getElementById('agregar');
const sel = document.getElementById('item');
const tbody = document.querySelector('#tabla tbody');
const totalEl = document.getElementById('total');

const precios = {
  "AUTOBUS 45 PLAZAS": 18500,
  "SPRINTER": 9500,
  "SUBURBAN": 4800,
  "SEDAN": 3200,
  "HOSPEDAJE": 1800,
  "VIATICOS": 1200
};

function agregarItem() {
  const texto = sel.value.trim();
  if (!texto) {
    alert("Selecciona un ítem primero");
    return;
  }

  console.log("Intentando agregar:", texto); // ← para depurar

  const precio = precios[texto] || 0;
  const fila = document.createElement('tr');
  fila.innerHTML = `
    <td><input type="number" value="1" min="1" class="cant" style="width:60px;"></td>
    <td>${texto}</td>
    <td><input type="number" value="${precio}" step="100" class="precio" style="width:110px;"></td>
    <td class="total-fila">$0.00</td>
    <td><button class="remove">×</button></td>
  `;
  tbody.appendChild(fila);

  const cant = fila.querySelector('.cant');
  const prec = fila.querySelector('.precio');
  const totCell = fila.querySelector('.total-fila');
  const btnRemove = fila.querySelector('.remove');

  function recalcular() {
    const c = Number(cant.value) || 0;
    const p = Number(prec.value) || 0;
    const totalFila = c * p;
    totCell.textContent = '$' + totalFila.toLocaleString('es-MX', {minimumFractionDigits: 2});
    calcularTotalGeneral();
  }

  cant.oninput = recalcular;
  prec.oninput = recalcular;
  btnRemove.onclick = () => { fila.remove(); calcularTotalGeneral(); };

  recalcular();           // calcula al crear
  sel.value = '';         // limpia el select
  console.log("Fila agregada OK");
}

function calcularTotalGeneral() {
  let suma = 0;
  document.querySelectorAll('.total-fila').forEach(td => {
    suma += Number(td.textContent.replace(/[$,]/g, '')) || 0;
  });
  totalEl.textContent = '$' + suma.toLocaleString('es-MX', {minimumFractionDigits: 2});
}

// Conectar botón
if (btn) {
  btn.onclick = agregarItem;
  console.log("Botón encontrado y evento asignado");
} else {
  console.error("¡No se encontró el botón con id='agregar'!");
}

// Prueba inicial
console.log("Script cargado correctamente");
</script>

</body>
</html>
